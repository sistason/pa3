#NOTE: TODOs are where you don't copy paste, but do stuff

#TODO: do some work here
#<new rasbian minimal>
#cp .ssh to /home/pi
#Start Raspberry Pi

#/bin/bash ---------------------------------------------
passwd -d pi    #remove password "raspberry" from user pi. Connection only via authorized_keys possible!
apt-get update
apt-get install git

# TODO: expand file system here
raspi-config
echo "reboot now"

cd /home/pi
#TODO: git config --global user.name "$NAME"
#TODO: git config --global user.email "$MAIL"
git clone git+ssh://pa/home/pruefungsamt/paPi
mv paPi/* paPi/.* .
rm -rf paPi

######### Install misc ###########
cp -R global_configs/_root /

apt-get install ferm vim screen tcpdump fswebcam imagemagick xinetd check-mk-agent

rm /etc/rc.local; ln -s /home/pi/global_configs/_etc/rc.local /etc/rc.local
rm /etc/fstab; ln -s /home/pi/global_configs/_etc/fstab /etc/fstab
rm /etc/ferm/ferm.conf; ln -s  /home/pi/global_configs/_etc/ferm.conf /etc/ferm/ferm.conf

ferm -i /etc/ferm/ferm.conf
# Check if /etc/xinet.d/check_mk has disable=no
# If not, service xinetd restart

mkdir -p /home/pi/camera/pictures
mkdir -p /home/pi/camera/fails  #not recognised pics
mount /home/pi/camera/pictures

#TODO: edit here. IMPORTANT, this sets the source of the pa!
echo "hostname paProjPiH??"

#TODO: set locale here
dpkg-reconfigure locales

########## Install Dependencies #########
 
apt-get install python-numpy python-opencv libssl-dev python-requests
apt-get remove python-openssl #Because of bug in the parsing of the Cert
